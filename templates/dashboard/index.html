{% extends 'partials/base.html' %}
{% load static %}
{% block title %} Home {% endblock title   %}
{% block content %} 
<link rel="stylesheet" href="{% static 'style.css' %}" />
{% if user.is_authenticated and user.is_staff and user.is_superuser %}

{% include 'partials/topnav.html' %} 
 <!--Graphs-->
 <div class="container">
    <div class="row my-5">
        <div class="col-md-6">
            <div class="bg-white">
                <h3>Ordered Quantity</h3>
                <canvas id="Order_Chart" width="400" height="300"></canvas>
                <script>
                    var ctx = document.getElementById('Order_Chart').getContext('2d');
                    var Order_Chart = new Chart(ctx, {
                        type: 'pie',
                        data: {
                            labels: [{% for order in order_labels %} '{{order}}',{% endfor %}],
                            datasets: [{
                                label: 'Orders',
                                data: [{% for order in order_quantities %} {{order}},{% endfor %}],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true
                                    }
                                }]
                            }
                        }
                    });
                </script>
            </div>
        </div>
        <div class="col-md-6">
            <div class="bg-white">
                <h3>Inventory Quantities</h3>
                <canvas id="Product_Chart" width="400" height="300"></canvas>
                <script>
                    var ctx = document.getElementById('Product_Chart').getContext('2d');
                    var Product_Chart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: [{% for product in product_names %} '{{ product }}', {% endfor %}],
                            datasets: [{
                                label: 'Products',
                                data: [{% for quantity in total_quantities %} {{ quantity }}, {% endfor %}],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true
                                    }
                                }]
                            }
                        }
                    });
                </script>
            </div>
        </div>
    </div>
    <div class="row my-5">
        <div class="col-md-6">
            <div class="bg-white">
                <h3>Number of Orders per Customer</h3>
                <canvas id="Order_per_Customer" width="400" height="300"></canvas>
                <script>
                    var ctx = document.getElementById('Order_per_Customer').getContext('2d');
                    var Order_per_Customer = new Chart(ctx, {
                        type: 'pie',
                        data: {
                            labels: [{% for order in orderer_labels %} '{{order}}',{% endfor %}],
                            datasets: [{
                                label: 'Orders',
                                data: [{% for order in orderer_quantities %} {{order}},{% endfor %}],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true
                                    }
                                }]
                            }
                        }
                    });
                </script>
            </div>
        </div>
        <div class="col-md-6">
                <h3>Inventory Category Based Quantities</h3>
                <canvas id="productCategoriesChart"></canvas>
                <script>
                    // Chart 1: Product Categories
                    var productCategoriesChartCtx = document.getElementById('productCategoriesChart').getContext('2d');
                var productCategoriesChart = new Chart(productCategoriesChartCtx, {
                type: 'doughnut',
                data: {
                    labels: [{% for label in category_labels %} '{{ label }}', {% endfor %}],
                    datasets: [{
                        data: [{% for quantity in category_quantities %} '{{ quantity }}', {% endfor %}],
                    backgroundColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                    ],
                    borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                    ],
                                    borderWidth: 1
                    }],
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                },
            });
                </script>
        </div>
    </div>
    <div class="col-md-6">

        <!-- Your HTML code -->
        <canvas id="expiration-chart"></canvas>

<!-- Chart.js library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>

<script>
// Your products data
expiratio_dates = [
{ name: "Product A", expiration_date: "2022-03-01" },
    { name: "Product B", expiration_date: "2022-03-15" },
    { name: "Product C", expiration_date: "2022-03-10" },
    { name: "Product D", expiration_date: "2022-03-05" },
    { name: "Product E", expiration_date: "2022-03-20" }
];

// Calculate the days left until expiration for each product
var labels = [];
var values = [];
for (var i = 0; i < expiratio_dates.length; i++) {
    var expirationDate = new Date(expiratio_dates[i].expiration_date);
    var now = new Date();
    var timeDiff = expirationDate.getTime() - now.getTime();
    var daysLeft = Math.ceil(timeDiff / (1000 * 3600 * 24));

    labels.append(expiratio_dates[i].name);
    values.append(daysLeft);
}

// Plot the chart using Chart.js
var ctx = document.getElementById("expiration-chart").getContext("2d");
var chart = new Chart(ctx, {
    type: "bar",
    data: {
        labels: labels,
        datasets: [
            {
                label: "Days left until expiration",
                data: values,
                backgroundColor: "rgba(255, 99, 132, 0.2)",
                borderColor: "rgba(255, 99, 132, 1)",
                borderWidth: 1
            }
        ]
    },
    options: {
        scales: {
            yAxes: [
                {
                    ticks: {
                        beginAtZero: true
                    }
                }
            ]
        }
    }
});
</script>

</div>

</div>
<!--End Graphs-->

{% else %}

{% include 'dashboard/staff_index.html' %}

{% endif %}

 {% endblock content  %} 
